@using System.Data;
@using System.Text;
@using Newtonsoft.Json;
@{
    ViewBag.Title = Resources.Global.OrganChart;

    if (ViewBag.JPost["M"].ToString() == "user")
    {
        ViewBag.Title += " - 사용자 선택";
    }
    else if (ViewBag.JPost["M"].ToString() == "group")
    {
        ViewBag.Title += " - 부서 선택";
    }
    else
    {
        //ViewBag.Title = Resources.Global.OrganChart;
    }
}

@if (ViewBag.JPost["M"].ToString() == "user")
{
<div class="modal-dialog modal-lg" style="max-width: 45rem">
    <div class="modal-content bg-white" style="box-shadow: 0px 5px 15px rgba(0,0,0,0.5)">
        <div class="modal-header bg-light py-2">
            <h6 class="modal-title">@ViewBag.Title</h6>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
            </button>
        </div>
        <div class="modal-body p-2">
            <div class="d-sm-flex">
                <div class="nav-tabs-top wd-99 wd-lg-40 wd-xl-40">
                    <ul class="nav nav-tabs">
                        <li class="nav-item">
                            <a class="nav-link py-2 active" data-toggle="tab" role="tab" href="#orgmaptree" aria-controls="orgmaptree" aria-selected="true">@Resources.Global.OrganChart</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link py-2" data-toggle="tab" role="tab" href="#orgmapsearch" aria-controls="orgmapsearch" aria-selected="false">@Resources.Global.Search</a>
                        </li>
                    </ul>
                    <!-- sidebox tree -->
                    <div class="tab-content p-2">
                        <div class="tab-pane fade show active" id="orgmaptree" role="tabpanel" aria-labelledby="orgtree-tab">
                            <div id="__OrgMapTree"></div>
                        </div>
                        <div class="tab-pane fade show" id="orgmapsearch" role="tabpanel" aria-labelledby="orgsearch-tab">
                            <form id="__OrgMapSearch">
                                <div class="form-group row">
                                    <label class="col-form-label col-sm-4 text-truncate">@Resources.Global.PersonName</label>
                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" placeholder="@Resources.Global.PersonName" data-for="ur">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-form-label col-sm-4 text-truncate">@Resources.Global.ID</label>
                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" placeholder="@Resources.Global.ID" data-for="urcn">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-form-label col-sm-4 text-truncate">@Resources.Global.Department</label>
                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" placeholder="@Resources.Global.Department" data-for="dept">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-form-label col-sm-4 text-truncate">@Resources.Global.Jikwi</label>
                                    <div class="col-sm-8">
                                        <select class="custom-select" data-for="grade">
                                            <option value="">@Resources.Global.Select</option>
                                            @foreach (DataRow row in ViewBag.GradeCode)
                                            {
                                                <option value="@row["Code"]">@row["CodeName"]</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-center">
                                    <button class="btn btn-outline-success py-1 mr-1">@Resources.Global.Search</button>
                                    <button class="btn btn-outline-secondary py-1 ml-1" type="reset">@Resources.Global.Reset</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- / sidebox tree -->
                </div>
                <div class="wd-99 wd-lg-60 wd-xl-60">
                    <div class="ml-2">
                        <div class="card">
                            <div class="card-header py-2">구성원</div>
                            <div id="__OrgMapMember">
                                <div class="card-body p-2">
                                    @foreach (DataRow dr in ViewBag.MemberList.Tables[0].Rows)
                                    {
                                        <div class="media align-items-center">
                                            <div class="wd-45">
                                                <label class="flex-fill custom-control custom-checkbox mb-0">
                                                    <input type="checkbox" class="custom-control-input" data-zf-member="@dr["UserID"];@dr["LogonID"];@dr["GR_ID"];@dr["GRAlias"]">
                                                    <span class="custom-control-label">@dr["DisplayName"]</span>
                                                </label>
                                            </div>
                                            <div class="wd-30 text-muted text-nowrap">@dr["Grade1"]</div>
                                            <div class="wd-25 text-muted text-nowrap">@dr["GRName"]</div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="card mt-2">
                            <div class="card-header py-2 d-flex justify-content-between">
                                <div class="font-weight-bold text-facebook">선택목록</div>
                                <div class="zf-sp-menu">
                                    <button type="button" class="btn btn-outline-success icon-btn btn-sm" data-toggle="tooltip" data-placement="bottom" title="추가" onclick="_XF.address.add('@ViewBag.Mode');"><i class="fas fa-user-plus"></i></button>
                                    <button type="button" class="btn btn-outline-secondary icon-btn btn-sm" data-toggle="tooltip" data-placement="bottom" title="삭제" onclick="_XF.address.remove('@ViewBag.Mode');"><i class="fas fa-user-minus"></i></button>
                                </div>
                            </div>
                            <div id="__AddressLine" style="height:130px">
                                <div class="card-body border-0 p-2 pb-0">
                                    <ul class="zf-sp-line"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">@Resources.Global.Close</button>
            <button type="button" class="btn btn-primary" data-zm-menu="confirm">@Resources.Global.Confirm</button>
        </div>
    </div>
</div>
}
