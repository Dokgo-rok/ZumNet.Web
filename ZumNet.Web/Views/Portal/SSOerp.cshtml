@using System.Data;
@using System.Data.SqlClient;
@using ZumNet.Framework.Base;
@using ZumNet.Framework.Core;
@using ZumNet.Framework.Data;

@{
    ViewBag.Title = "ERP";
    Layout = "~/Views/Shared/Layouts/_LayoutNone.cshtml";

    string strReturn = "";
    string strConnect = DbConnect.GetString(DbConnect.INITIAL_CATALOG.INIT_CAT_BASE);
    string strQuery = "SELECT Keyword7 FROM admin.PH_USER_DETAIL (NOLOCK) WHERE UserID = @urid";

    SqlParameter[] parameters = new SqlParameter[]
    {
        ParamSet.Add4Sql("@urid", SqlDbType.Int, 4, Convert.ToInt32(Session["URID"]))
    };

    ParamData pData = new ParamData(strQuery, "text", parameters);

    using (DbBase db = new DbBase())
    {
        strReturn = db.ExecuteScalarNTx(strConnect, System.Reflection.MethodInfo.GetCurrentMethod(), pData);
    }

    string stgrPwd = Request.ServerVariables["AUTH_PASSWORD"];
    //Response.Write(ZumNet.Framework.Configuration.Config.Read("erpUrl"));
}

<div style="margin-top: 100px; text-align: center; font-weight: bold">
    <h4>잠시만 기다려 주십시오!</h4>
</div>

<form id="ssoForm" name="ssoForm" method="post" action="@ZumNet.Framework.Configuration.Config.Read("erpUrl")OA_HTML/Ssl_Login.jsp">
    <input type="hidden" name="username" value="@strReturn" />
    <input type="hidden" name="password" value="@stgrPwd" />
    <input type="hidden" name="langCode" value="US" />
</form>

@section Scripts {
    <script type="text/javascript">
        //$(function () { $('ssoForm').submit(); });

        (function () {
            //ssoForm.submit();
            location.href = "@ZumNet.Framework.Configuration.Config.Read("erpUrl")OA_HTML/AppsLocalLogin.jsp?requestUrl=APPSHOMEPAGE&cancelUrl=http%3A%2F%2Ferpap.cresyn.com%3A8000%2FOA_HTML%2FAppsLocalLogin.jsp&errCode=FND_APPL_LOGIN_FAILED&langCode=US&username=@strReturn";
        }());
    </script>
}
