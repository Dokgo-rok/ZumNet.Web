@using System.Data;
@using System.Text;
@{
    int maxPage = ZumNet.Web.Bc.CommonUtils.IsMobile() ? 5 : 10;
    int totalCount = Convert.ToInt32(ViewBag.Total);
    int pageCount = Convert.ToInt32(ViewBag.JPost["count"]);
    int pageIndex = Convert.ToInt32(ViewBag.JPost["page"]);
    int totalPage = totalCount / pageCount;

    if (totalCount % pageCount > 0) { totalPage++; }
    if (pageIndex > totalPage) { pageIndex = totalPage; }

    int iStart = 0;
    int iEnd = 0;

    if (totalPage <= maxPage)
    {
        iStart = 2;
        iEnd = totalPage - 1;
    }
    else if (pageIndex >= maxPage && (totalPage - maxPage + 1 >= pageIndex))
    {
        iStart = pageIndex - 1;
        iEnd = pageIndex + 1;
    }
    else if (pageIndex < maxPage)
    {
        iStart = 2;
        iEnd = maxPage;
    }
    else if (pageIndex > totalPage - maxPage + 1)
    {
        iStart = totalPage - maxPage + 1;
        iEnd = totalPage - 1;
    }

    string sPage = String.Format("{0} {1} {2} ({3} / {4} {5})", Resources.Global.Total, totalCount.ToString(), Resources.Global.Count, pageIndex.ToString(), totalPage.ToString(), Resources.Global.Page);
}
@functions{
    private string Render(string pos)
    {
        StringBuilder sb = new StringBuilder();
        if (ViewBag.JPost["M"] == null || ViewBag.JPost["M"] == "")
        {
            if (pos == "f")
            {
                sb.Append("<div class=\"modal-dialog modal-dialog-scrollable\" role=\"document\" style=\"max-width: 50rem\">");
                sb.Append("<div class=\"modal-content bg-white\" style=\"box-shadow: 0px 5px 15px rgba(0,0,0,0.5)\">");
                sb.Append("<div class=\"modal-header bg-light\">");
                sb.AppendFormat("<h6 class=\"modal-title\">{0}</h6>", "문서 검색");
                sb.Append("<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">");
                sb.Append("<span aria-hidden=\"true\">&times;</span>");
                sb.Append("</button>");
                sb.Append("</div>");
                sb.Append("<div class=\"modal-body px-1 p-sm-2\">"); //modal-body
            }
            else if (pos == "b")
            {
                sb.Append("</div>"); //modal-body
                sb.Append("<div class=\"modal-footer border-0 pt-0 px-2\">");
                sb.Append("<table class=\"table table-bordered mt-0\">");
                sb.Append("<colgroup><col style=\"width: 15%\" /><col style=\"width: 70%\" /><col style=\"width: 15%\" /></colgroup>");
                sb.Append("<tbody>");
                sb.Append("<tr>");
                sb.AppendFormat("<td class=\"bg-light\" style=\"font-weight: bold; text-align: center; vertical-align: middle\">{0}</td>", "첨부목록");
                sb.Append("<td>");
                sb.Append("<ul class=\"list-group\"></ul>");
                sb.Append("</td>");
                sb.Append("<td class=\"bg-light py-2\">");
                sb.AppendFormat("<button type=\"button\" class=\"btn btn-primary btn-block py-0\" data-zm-menu=\"confirm\">{0}</button>", Resources.Global.Confirm);
                sb.AppendFormat("<button type=\"button\" class=\"btn btn-secondary btn-block py-0 mt-1\" data-dismiss=\"modal\">{0}</button>", Resources.Global.Cancel);
                sb.Append("</td>");
                sb.Append("</tr>");
                sb.Append("</tbody>");
                sb.Append("</table>");
                sb.Append("</div>");
                sb.Append("</div>");
                sb.Append("</div>");
            }
        }
        return sb.ToString();
    }
}
@Html.Raw(Render("f"))
    <div class="d-flex align-items-center justify-content-between mb-2">
        <div class="input-group z-lv-cond wd-50 wd-lg-60 wd-xl-65 flex-nowrap">
            <select class="custom-select">
                <option value="FDName" @(ViewBag.JPost["search"].ToString() == "FDName" ? " selected" : "")>문서분류</option>
                <option value="Subject" @(ViewBag.JPost["search"].ToString() == "CreatorID" || ViewBag.JPost["search"].ToString() == "Subject" ? " selected" : "")>@Resources.Global.Title</option>
                <option value="Creator" @(ViewBag.JPost["search"].ToString() == "Creator" ? " selected" : "")>@Resources.Global.Writer</option>
                <option value="CreatorDept" @(ViewBag.JPost["search"].ToString() == "CreatorDept" ? " selected" : "")>@Resources.Global.WriteDept</option>
                <option value="CreateDate" @(ViewBag.JPost["search"].ToString() == "CreateDate" ? " selected" : "")>@Resources.Global.Date_Created</option>
            </select>
            <input type="text" class="form-control search-text" style="min-width: 6rem" placeholder="@Resources.Global.Search" value="@(ViewBag.JPost["search"].ToString() == "CreatorID" ? "" : ViewBag.JPost["searchtext"].ToString())">
            <div class="datepicker input-group input-daterange z-lv-date wd-xl-45">
                <input type="text" class="form-control start-date bg-white" value="@ViewBag.JPost["start"]">
                <div class="input-group-prepend">
                    <span class="input-group-text">~</span>
                </div>
                <input type="text" class="form-control end-date bg-white" value="@ViewBag.JPost["end"]">
            </div>
            <span class="input-group-append">
                <button class="btn btn-secondary" type="button" data-toggle="tooltip" data-placement="bottom" title="@Resources.Global.Search" data-zm-menu="search"><i class="fe-search"></i></button>
            </span>
        </div>
        <div class="px-1 flex-grow-1"></div>
        <div class="">
            <i class="fe-chevron-right"></i> @sPage
        </div>
    </div>
    <ul class="z-lv-hdr list-group">
        <li class="list-group-item list-group-item-action d-flex align-items-center py-2" style="background-color: rgba(32, 201, 151, 0.1)">
            <div class="wd-md-25 wd-lg-18 wd-xl-18 text-truncate pr-2">
                <a href="javascript:void(0)" data-val="FDName">문서분류<i class="@(ViewBag.JPost["sort"].ToString() == "FDName" ? (ViewBag.JPost["sortdir"].ToString() == "ASC" ? "fe-arrow-up" : "fe-arrow-down") : "")"></i></a>
            </div>
            <div class="d-none d-md-block wd-lg-5 wd-xl-5 text-truncate text-center">
                <span class="">Rev</span>
            </div>
            <div class="wd-md-40 wd-lg-34 wd-xl-34 text-truncate pr-2">
                <a href="javascript:void(0)" data-val="Subject">@Resources.Global.Title<i class="@(ViewBag.JPost["sort"].ToString() == "Subject" ? (ViewBag.JPost["sortdir"].ToString() == "ASC" ? "fe-arrow-up" : "fe-arrow-down") : "")"></i></a>
            </div>
            <div class="wd-md-10 wd-lg-10 wd-xl-10 text-truncate text-center">
                <span class="">권한</span>
            </div>
            <div class="wd-md-15 wd-lg-10 wd-xl-10 text-truncate text-center">
                <a href="javascript:void(0)" data-val="Creator">@Resources.Global.Writer<i class="@(ViewBag.JPost["sort"].ToString() == "Creator" ? (ViewBag.JPost["sortdir"].ToString() == "ASC" ? "fe-arrow-up" : "fe-arrow-down") : "")"></i></a>
            </div>
            <div class="d-none d-md-block wd-lg-15 wd-xl-15 text-truncate text-center">
                <a href="javascript:void(0)" data-val="CreatorDept">@Resources.Global.WriteDept<i class="@(ViewBag.JPost["sort"].ToString() == "CreatorDept" ? (ViewBag.JPost["sortdir"].ToString() == "ASC" ? "fe-arrow-up" : "fe-arrow-down") : "")"></i></a>
            </div>
            <div class="text-right flex-fill text-truncate pr-1">
                <a href="javascript:void(0)" data-val="CreateDate">@Resources.Global.Date_Created<i class="@(ViewBag.JPost["sort"].ToString() == "CreateDate" ? (ViewBag.JPost["sortdir"].ToString() == "ASC" ? "fe-arrow-up" : "fe-arrow-down") : "")"></i></a>
            </div>
        </li>
    </ul>
    <ul class="list-group">
        @if (ViewBag.BoardList != null && ViewBag.BoardList.Rows.Count > 0)
        {
            foreach (DataRow row in ViewBag.BoardList.Rows)
            {
                <li class="z-lv-row list-group-item list-group-item-action d-flex align-items-center py-2">
                    <div class="wd-md-25 wd-lg-18 wd-xl-18 text-truncate pr-2">
                        <span class="">@row["FDName"]</span>
                    </div>
                    <div class="d-none d-md-block wd-lg-5 wd-xl-5 text-truncate text-center">
                        <span class="">@row["Reserved1"]</span>
                    </div>
                    <div class="wd-md-40 wd-lg-34 wd-xl-34 text-truncate pr-2">
                        <a href="javascript:" class="z-lnk-navy" xf="@row["XFAlias"]" mi="@row["MessageID"]" sys="@row["SysName"]" acl="@row["Permission"]">@row["Subject"]</a>
                    </div>
                    <div class="wd-md-10 wd-lg-10 wd-xl-10 text-truncate text-center">
                        @if (row["Permission"].ToString().Substring(4, 1) == "R")
                        {
                            <i class="fab fa-sistrix rotate-90"></i>
                        }
                        else
                        {
                            <span class="px-1">&nbsp;</span>
                        }
                        @if (row["Permission"].ToString().Substring(2, 1) == "E")
                        {
                            <i class="fe-edit-2"></i>
                        }
                        else
                        {
                            <span class="px-1">&nbsp;</span>
                        }
                        @if (row["Permission"].ToString().Substring(1, 1) == "D")
                        {
                            <i class="fe-x"></i>
                        }
                        else
                        {
                            <span class="px-1">&nbsp;</span>
                        }
                    </div>
                    <div class="wd-md-15 wd-lg-10 wd-xl-10 text-truncate text-center">
                        <span class="">@row["Creator"]</span>
                    </div>
                    <div class="d-none d-md-block wd-lg-15 wd-xl-15 text-truncate text-center">
                        <span class="">@row["CreatorDept"]</span>
                    </div>
                    <div class="text-right flex-fill text-truncate pr-1">
                        <span class="">@ZumNet.Web.Bc.CommonUtils.LvDate(row["CreateDate"].ToString())</span>
                    </div>
                </li>
            }
        }
        else
        {
            <li class="d-flex align-items-center">
                <div class="w-100 text-center py-3">@Resources.Global.NoItemShow</div>
            </li>
        }
    </ul>
    <ul class="pagination pagination-sm justify-content-center mb-0 pt-2">
        @if (totalPage > 1)
        {
            if (pageIndex > 1)
            {
                <li class="page-item page-pre"><a class="page-link" title="@Resources.Global.Previous" href="javascript:void(0)" data-for="@(pageIndex - 1)"><i class="fe-chevron-left"></i></a></li>
                <li class="page-item"><a class="page-link" title="@Resources.Global.First @Resources.Global.Page" href="javascript:void(0)" data-for="1">1</a></li>
            }
            else
            {
                <li class="page-item page-pre disabled"><a class="" title="@Resources.Global.Previous" href="javascript:void(0)" data-for=""><i class="fe-chevron-left"></i></a></li>
                <li class="page-item active"><a class="" title="@Resources.Global.First @Resources.Global.Page" href="javascript:void(0)" data-for="1">1</a></li>
            }

            if (totalPage > (maxPage + 2) && pageIndex >= maxPage)
            {
                <li class="page-item page-first-separator disabled"><a class="" title="" href="javascript:void(0)">...</a></li>
            }

            for (int i = iStart; i <= iEnd; i++)
            {
                if (pageIndex == i)
                {
                    <li class="page-item active"><a class="" title="@i @Resources.Global.Page" href="javascript:void(0)" data-for="@i">@i</a></li>
                }
                else
                {
                    <li class="page-item"><a class="page-link" title="@i @Resources.Global.Page" href="javascript:void(0)" data-for="@i">@i</a></li>
                }
            }

            if (totalPage > (maxPage + 2) && pageIndex > 0 && pageIndex <= (totalPage - maxPage + 1))
            {
                <li class="page-item page-last-separator disabled"><a class="" title="" href="javascript:void(0)">...</a></li>
            }

            if (pageIndex < totalPage)
            {
                <li class="page-item"><a class="page-link" title="@Resources.Global.Last2 @Resources.Global.Page" href="javascript:void(0)" data-for="@totalPage">@totalPage</a></li>
                <li class="page-item page-next"><a class="page-link" title="@Resources.Global.Next" href="javascript:void(0)" data-for="@(pageIndex + 1)"><i class="fe-chevron-right"></i></a></li>
            }
            else
            {
                <li class="page-item active"><a class="" title="@Resources.Global.Last2 @Resources.Global.Page" href="javascript:void(0)" data-for="@totalPage">@totalPage</a></li>
                <li class="page-item page-next disabled"><a class="" title="@Resources.Global.Next" href="javascript:void(0)" data-for=""><i class="fe-chevron-right"></i></a></li>
            }
        }
    </ul>
@Html.Raw(Render("b"))
