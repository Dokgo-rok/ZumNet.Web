@using System;
@using System.Collections;
@using System.Collections.Generic;
@using System.Data;
@using System.IO;
@using System.Text;
@using Newtonsoft.Json;
@using Newtonsoft.Json.Linq;
@using ZumNet.BSL.ServiceBiz;
@using ZumNet.BSL.InterfaceBiz;
@using ZumNet.Web.Bc;
@using ZumNet.Framework.Core;
@using ZumNet.Framework.Exception;
@using ZumNet.Framework.Util;
@functions{
    private string GetCodeDescription(JObject postData)
    {
        ServiceResult svcRt = new ServiceResult();
        StringBuilder sb = new StringBuilder();

        string strBodyMode = postData.ContainsKey("body") ? postData["body"].ToString() : ""; // S(문자열반환), N(modal-body 없음), F(footer 포함)
        string strReturn = "";

        try
        {
            if (strBodyMode != "N")
            {
                sb.Append("<div class=\"zf-modal modal-dialog modal-dialog-centered modal-dialog-scrollable modal-sm\">");
                sb.AppendFormat("<div class=\"modal-content\" data-for=\"{0}\" style=\"box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.5)\">", postData["k2"].ToString());
                sb.Append("<div class=\"modal-header\">");
                sb.Append("<h6 class=\"modal-title\"></h6>");
                sb.Append("<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>");
                //sb.AppendFormat("<input type=\"hidden\" data-for=\"param\" value=\"{0}\" />", postData["param"].ToString());
                sb.Append("</div>");
                sb.Append("<div class=\"modal-body\">"); //modal-body
            }

            using (CommonBiz comBiz = new CommonBiz())
            {
                svcRt = comBiz.SelectCodeDescription(postData["k1"].ToString(), postData["k2"].ToString(), postData["k3"].ToString());
            }

            if (svcRt.ResultCode == 0)
            {
                if (svcRt.ResultItemCount > 0)
                {
                    if (postData["k2"].ToString() == "currency" || postData["k2"].ToString() == "centercode" || postData["k2"].ToString() == "centercode2" || postData["k2"].ToString() == "chartcentercode" || postData["k2"].ToString() == "prodlawname")
                    {
                        # region [통화, 생산지표기]
                        sb.Append("<table class=\"table table-striped table-sm mb-0\">");
                        if (postData.ContainsKey("fn") && postData["fn"].ToString() == "checkbox")
                        {
                            //복수선택
                            sb.Append("<colgroup><col width=\"5%\" /><col width=\"55%\" /><col width=\"40%\" /></colgroup>");
                            sb.Append("<tbody>");
                            foreach (DataRow row in svcRt.ResultDataSet.Tables[0].Rows)
                            {
                                sb.Append("<tr>");
                                sb.AppendFormat("<td><input type=\"checkbox\" name=\"ckbMultiOption\" value=\"{0}\" /></td>", row["item1"].ToString());
                                sb.AppendFormat("<td>{0}</td>", row["item2"].ToString());
                                sb.AppendFormat("<td>{0}</td>", row["item1"].ToString());
                                sb.Append("</tr>");
                            }
                            if (postData["etc"].ToString() == "etc")
                            {
                                sb.Append("<tr><td><input type=\"checkbox\" name=\"ckbMultiOption\" value=\"\" /></td><td>기타<td><input type=\"text\" class=\"form-control z-input-in\" /></td></tr>");
                            }
                            sb.Append("</tbody>");
                        }
                        else
                        {
                            sb.Append("<colgroup><col width=\"60%\" /><col width=\"40%\" /></colgroup>");
                            sb.Append("<tbody>");
                            foreach (DataRow row in svcRt.ResultDataSet.Tables[0].Rows)
                            {
                                sb.Append("<tr>");
                                sb.AppendFormat("<td>{0}</td>", row["item2"].ToString());
                                if (postData["etc"].ToString() == "orgcode") sb.AppendFormat("<td><a class=\"z-lnk-navy\" href=\"javascript:void(0)\" data-val=\"{0}^{1}^{2}\">{0}</a></td>", row["item1"].ToString(), row["item3"].ToString(), row["item4"].ToString());
                                else sb.AppendFormat("<td><a class=\"z-lnk-navy\" href=\"javascript:void(0)\" data-val=\"{0}\">{0}</a></td>", row["item1"].ToString());
                                sb.Append("</tr>");
                            }
                            if (postData["etc"].ToString() == "etc")
                            {
                                sb.Append("<tr><td>기타</td><td><input type=\"text\" class=\"form-control z-input-in\" /></td></tr>");
                            }
                            sb.Append("</tbody>");
                        }
                        sb.Append("</table>");
                        #endregion
                    }
                    else if (postData["k2"].ToString() == "toolingmakingreq")
                    {
                        #region [toolingmakingreq]
                        sb.Append("<table class=\"table table-striped table-sm mb-0\">");
                        if (postData.ContainsKey("fn") && postData["fn"].ToString() == "checkbox")
                        {
                            //복수선택
                            sb.Append("<colgroup><col width=\"5%\" /><col width=\"20%\" /><col width=\"75%\" /></colgroup>");
                            sb.Append("<tbody>");
                            foreach (DataRow row in svcRt.ResultDataSet.Tables[0].Rows)
                            {
                                sb.Append("<tr>");
                                sb.AppendFormat("<td><input type=\"checkbox\" name=\"ckbMultiOption\" value=\"{0}\" /></td>", row["item2"].ToString());
                                sb.AppendFormat("<td>{0}</td>", row["item1"].ToString());
                                sb.AppendFormat("<td>{0}</td>", row["item2"].ToString());
                                sb.Append("</tr>");
                            }
                            if (postData["etc"].ToString() == "etc")
                            {
                                sb.Append("<tr><td><input type=\"checkbox\" name=\"ckbMultiOption\" value=\"\" /></td><td>기타<td><input type=\"text\" class=\"form-control z-input-in\" /></td></tr>");
                            }
                            sb.Append("</tbody>");
                        }
                        else
                        {
                            sb.Append("<colgroup><col width=\"20%\" /><col width=\"80%\" /></colgroup>");
                            sb.Append("<tbody>");
                            foreach (DataRow row in svcRt.ResultDataSet.Tables[0].Rows)
                            {
                                sb.Append("<tr>");
                                sb.AppendFormat("<td>{0}</td>", row["item1"].ToString());
                                if (postData["etc"].ToString() == "orgcode") sb.AppendFormat("<td><a class=\"z-lnk-navy\" href=\"javascript:void(0)\" data-val=\"{0}^{1}^{2}\">{0}</a></td>", row["item2"].ToString(), row["item3"].ToString(), row["item4"].ToString());
                                else sb.AppendFormat("<td><a class=\"z-lnk-navy\" href=\"javascript:void(0)\" data-val=\"{0}\">{0}</a></td>", row["item2"].ToString());
                                sb.Append("</tr>");
                            }
                            if (postData["etc"].ToString() == "etc")
                            {
                                sb.Append("<tr><td>기타</td><td><input type=\"text\" class=\"form-control z-input-in\" /></td></tr>");
                            }
                            sb.Append("</tbody>");
                        }
                        sb.Append("</table>");
                        #endregion
                    }
                    else if (postData["k2"].ToString() == "conclassify")
                    {
                        #region [conclassify]
                        sb.Append("<table class=\"table table-striped table-sm text-center mb-0\">");
                        sb.Append("<colgroup><col width=\"20%\" /><col width=\"40%\" /><col width=\"20%\" /><col width=\"20%\" /></colgroup>");
                        sb.Append("<tbody>");
                        foreach (DataRow row in svcRt.ResultDataSet.Tables[0].Rows)
                        {
                            sb.Append("<tr>");
                            sb.AppendFormat("<td>{0}</td>", row["item2"].ToString());
                            sb.AppendFormat("<td><a class=\"z-lnk-navy\" href=\"javascript:void(0)\" data-val=\"{0}^{1}^{2}^{3}^{4}\">{0}</a></td>"
                                , row["item3"].ToString(), row["item1"].ToString(), row["item2"].ToString(), row["item4"].ToString(), row["item5"].ToString());
                            sb.AppendFormat("<td>{0}</td>", row["item4"].ToString());
                            sb.AppendFormat("<td>{0}</td>", row["item5"].ToString());
                            sb.Append("</tr>");
                        }
                        sb.Append("</tbody>");
                        sb.Append("</table>");
                        #endregion
                    }
                    else
                    {
                        sb.Append("<table class=\"table table-striped table-sm text-center mb-0\">");
                        sb.Append("<tbody>");
                        foreach (DataRow row in svcRt.ResultDataSet.Tables[0].Rows)
                        {
                            sb.AppendFormat("<tr><td><a class=\"z-lnk-navy\" href=\"javascript:void(0)\" data-val=\"{0}\">{0}</a></td></tr>", row["item1"].ToString());
                        }
                        if (postData["etc"].ToString() == "etc")
                        {
                            sb.Append("<tr><td><input type=\"text\" class=\"form-control z-input-in\" /></td></tr>");
                        }
                        sb.Append("</tbody>");
                        sb.Append("</table>");
                    }
                }
                else
                {
                    sb.AppendFormat("<div class=\"text-center mt-3 h5 text-secondary\">{0}</div>", Resources.Global.NoItemShow);
                }
            }
            else
            {
                strReturn = svcRt.ResultMessage;
            }

            if (strBodyMode != "N")
            {
                sb.Append("</div>"); //modal-body

                if (strBodyMode == "F")
                {
                    sb.Append("<div class=\"modal-footer\">"); //modal-footer
                    sb.Append("<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">닫기</button>");
                    sb.Append("<button type=\"button\" class=\"btn btn-primary\" data-zm-menu=\"confirm\">확인</button>");
                    sb.Append("</div>");
                }

                sb.Append("</div>"); //content
                sb.Append("</div>");
            }

            if(strReturn == "") strReturn = "OK" + sb.ToString();
        }
        catch (Exception ex)
        {
            ExceptionManager.Publish(ex, ExceptionManager.ErrorLevel.Error, "GetCodeDescription");
            strReturn = (strReturn != "" ? "[" + strReturn + "] " : "") + ex.Message;
        }
        finally
        {
        }
        return strReturn;
    }
}
@Html.Raw(GetCodeDescription(ViewBag.JPost))