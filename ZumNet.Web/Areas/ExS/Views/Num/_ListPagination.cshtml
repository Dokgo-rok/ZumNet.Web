@using System.Data;
@using System.Text;

@{
    int maxPage = 0;
    int totalCount = 0;
    int pageCount = 0;
    int pageIndex = 0;
    int totalPage = 0;

    int iStart = 0;
    int iEnd = 0;

    maxPage = ZumNet.Web.Bc.CommonUtils.IsMobile() ? 5 : 10;
    totalCount = Convert.ToInt32(ViewBag.R.lv.total.Value);
    pageCount = Convert.ToInt32(ViewBag.R.lv.count.Value);
    pageIndex = Convert.ToInt32(ViewBag.R.lv.page.Value);
    totalPage = totalCount / pageCount;

    if (totalCount % pageCount > 0) { totalPage++; }
    if (pageIndex > totalPage) { pageIndex = totalPage; }

    if (totalPage <= maxPage)
    {
        iStart = 2;
        iEnd = totalPage - 1;
    }
    else if (pageIndex >= maxPage && (totalPage - maxPage + 1 >= pageIndex))
    {
        iStart = pageIndex - 1;
        iEnd = pageIndex + 1;
    }
    else if (pageIndex < maxPage)
    {
        iStart = 2;
        iEnd = maxPage;
    }
    else if (pageIndex > totalPage - maxPage + 1)
    {
        iStart = totalPage - maxPage + 1;
        iEnd = totalPage - 1;
    }
}

@if (totalPage > 1)
{
    <ul class="pagination pagination-sm justify-content-center">
    @if (pageIndex > 1)
    {
        <li class="page-item page-pre"><a class="page-link" title="@Resources.Global.Previous" href="javascript:void(0)" data-for="@(pageIndex - 1)"><i class="fe-chevron-left"></i></a></li>
        <li class="page-item"><a class="page-link" title="@Resources.Global.First @Resources.Global.Page" href="javascript:void(0)" data-for="1">1</a></li>
    }
    else
    {
        <li class="page-item page-pre disabled"><a class="" title="@Resources.Global.Previous" href="javascript:void(0)" data-for=""><i class="fe-chevron-left"></i></a></li>
        <li class="page-item active"><a class="" title="@Resources.Global.First @Resources.Global.Page" href="javascript:void(0)" data-for="1">1</a></li>
    }

    @if (totalPage > (maxPage + 2) && pageIndex >= maxPage)
    {
        <li class="page-item page-first-separator disabled"><a class="" title="" href="javascript:void(0)">...</a></li>
    }

    @for (int i = iStart; i <= iEnd; i++)
    {
    if (pageIndex == i)
    {
        <li class="page-item active"><a class="" title="@i @Resources.Global.Page" href="javascript:void(0)" data-for="@i">@i</a></li>
    }
    else
    {
        <li class="page-item"><a class="page-link" title="@i @Resources.Global.Page" href="javascript:void(0)" data-for="@i">@i</a></li>
    }
    }

    @if (totalPage > (maxPage + 2) && pageIndex > 0 && pageIndex <= (totalPage - maxPage + 1))
    {
        <li class="page-item page-last-separator disabled"><a class="" title="" href="javascript:void(0)">...</a></li>
    }

    @if (pageIndex < totalPage)
    {
        <li class="page-item"><a class="page-link" title="@Resources.Global.Last2 @Resources.Global.Page" href="javascript:void(0)" data-for="@totalPage">@totalPage</a></li>
        <li class="page-item page-next"><a class="page-link" title="@Resources.Global.Next" href="javascript:void(0)" data-for="@(pageIndex + 1)"><i class="fe-chevron-right"></i></a></li>
    }
    else
    {
        <li class="page-item active"><a class="" title="@Resources.Global.Last2 @Resources.Global.Page" href="javascript:void(0)" data-for="@totalPage">@totalPage</a></li>
        <li class="page-item page-next disabled"><a class="" title="@Resources.Global.Next" href="javascript:void(0)" data-for=""><i class="fe-chevron-right"></i></a></li>
    }
    </ul>
}
