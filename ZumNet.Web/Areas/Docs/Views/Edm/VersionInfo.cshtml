@using System.Data;
@using System.Text;
@using Newtonsoft.Json;
@using Newtonsoft.Json.Linq;
@using ZumNet.Framework.Util;
@{
    string sFileName = ViewBag.BoardList.Rows[ViewBag.BoardList.Rows.Count - 1]["FileName"].ToString();

    string mode = ViewBag.JPost["m"] == null || ViewBag.JPost["m"].ToString() == "" ? "modal" : ViewBag.JPost["m"].ToString();
}
@if (mode == "modal")
{
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title">"@sFileName" 버전 정보</h6>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body py-2">
                <table class="table table-striped table-sm text-center mb-0">
                    <colgroup><col style="width:20%" /><col style="width:20%" /><col style="width:20%" /><col style="width:20%" /><col style="width:20%" /></colgroup>
                    <thead>
                        <tr><th>버전</th><th>기본</th><th>이력</th><th>등록자</th><th>등록일</th></tr>
                    </thead>
                    <tbody>
                        @for (int i = ViewBag.BoardList.Rows.Count - 1; i >= 0; i--)
                        {
                            DataRow row = ViewBag.BoardList.Rows[i];
                            <tr>
                                <td><a class="z-lnk-navy-n" href="/Common/Download?fn=@Server.UrlEncode(SecurityHelper.ToBase64(row["FileName"].ToString()))&fp=@Server.UrlEncode(SecurityHelper.ToBase64("\\" + row["FilePath"].ToString() + "\\" + row["SavedName"].ToString()))" target="_blank">@row["Ver"]</a></td>
                                <td>
                                    @if (row["IsBase"].ToString() == "Y")
                                    {<i class="far fa-circle"></i>}
                                </td>
                                <td>@row["LogCount"]</td>
                                <td>@row["CreatorName"]</td>
                                <td>@ZumNet.Web.Bc.CommonUtils.LvDate(row["RegisteredDate"].ToString())</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-zm-menu="confirm">@Resources.Global.Confirm</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">@Resources.Global.Cancel</button>
            </div>
        </div>
    </div>
}
else if (mode == "card")
{
    <div class="card">
        @*<div class="card-body p-1 bg-light">
                <div class="bg-white" style="height: 200px">
                    <div class="mb-0 px-0" style="overflow: hidden">
                        <table class="table table-striped table-sm text-center mb-0">
                            <colgroup><col style="width:15%" /><col style="width:15%" /><col style="width:15%" /><col /><col style="width:25%" /></colgroup>
                            <thead>
                                <tr class="table-success"><th>버전</th><th>기본</th><th>이력</th><th>등록자</th><th>등록일</th></tr>
                            </thead>
                        </table>
                    </div>
                    <div class="" style="position: absolute; top: 2.2rem; left: 0; right: 0; bottom: 0; overflow: auto;">
                        <table class="table table-striped table-sm text-center mb-0">
                            <colgroup><col style="width:15%" /><col style="width:15%" /><col style="width:15%" /><col /><col style="width:25%" /></colgroup>
                            <tbody>
                                @for (int i = ViewBag.BoardList.Rows.Count - 1; i >= 0; i--)
                                {
                                    DataRow row = ViewBag.BoardList.Rows[i];
                                    <tr>
                                        <td><a class="z-lnk-navy-n" href="/Common/Download?fn=@Server.UrlEncode(SecurityHelper.ToBase64(row["FileName"].ToString()))&fp=@Server.UrlEncode(SecurityHelper.ToBase64("\\" + row["FilePath"].ToString() + "\\" + row["SavedName"].ToString()))" target="_blank">@row["Ver"]</a></td>
                                        <td>
                                            @if (row["IsBase"].ToString() == "Y")
                                            {<i class="far fa-circle"></i>}
                                        </td>
                                        <td>@row["LogCount"]</td>
                                        <td>@row["CreatorName"]</td>
                                        <td>@ZumNet.Web.Bc.CommonUtils.LvDate(row["RegisteredDate"].ToString())</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>*@
        <div class="card-body p-1 bg-light">
            <div class="bg-white" style="max-height: 200px; overflow: auto">
                <table class="table table-hover table-sm text-center mb-0">
                    <colgroup><col style="width:15%" /><col style="width:15%" /><col style="width:15%" /><col /><col style="width:25%" /></colgroup>
                    <thead>
                        <tr class="table-success"><th>버전</th><th>기본</th><th>이력</th><th>등록자</th><th>등록일</th></tr>
                    </thead>
                    <tbody>
                        @for (int i = ViewBag.BoardList.Rows.Count - 1; i >= 0; i--)
                        {
                            DataRow row = ViewBag.BoardList.Rows[i];

                            JObject j = JObject.Parse("{}");
                            j["attachid"] = row["AttachID"].ToString();
                            j["filename"] = row["FileName"].ToString().Trim();
                            j["savedname"] = row["SavedName"].ToString();
                            j["ver"] = row["Ver"].ToString();
                            j["isbase"] = row["IsBase"].ToString();
                            j["docleveltext"] = row["DocLevel"].ToString();
                            j["keepyeartext"] = row["KeepYear"].ToString();
                            j["docnumber"] = row["DocNumber"].ToString();
                            j["regdate"] = row["RegisteredDate"].ToString();
                            j["crur"] = row["CreatorName"].ToString();
                            j["filepath"] = row["FilePath"].ToString();

                            <tr>
                                <td><a class="z-lnk-navy-n d-inline-block w-100" href="javascript://" data-val="@Server.HtmlEncode(JsonConvert.SerializeObject(j))">@row["Ver"]</a></td>
                                <td>
                                    @if (row["IsBase"].ToString() == "Y")
                                    {<i class="fas fa-check"></i>}
                                </td>
                                <td>@row["LogCount"]</td>
                                <td>@row["CreatorName"]</td>
                                <td>@ZumNet.Web.Bc.CommonUtils.LvDate(row["RegisteredDate"].ToString())</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}
else
{
    <div class="">@Resources.Global.NoItemShow</div>
}

